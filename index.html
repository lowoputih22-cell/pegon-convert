<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Pegon_Converter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
  body { font-family: 'Inter', sans-serif; }

  /* Efek glow tombol GOLD */
  .gold-glow:hover {
    box-shadow: 0 0 0px rgba(0,0,0,0), 
                0 8px 30px rgba(202,138,4,0.35);
  }

  /* Efek glow tombol HIJAU */
  .green-glow:hover {
    box-shadow: 0 0 0px rgba(0,0,0,0), 
                0 8px 30px rgba(20,83,45,0.35);
  }
</style>
  <style>
  .toast-show {
    opacity: 1 !important;
    transform: translateY(0) !important;
    pointer-events: auto !important;
  }
</style>
  <style>
  @keyframes fadeInScale {
    from { opacity:0; transform: scale(.95); }
    to { opacity:1; transform: scale(1); }
  }
  .animate-fade-in {
    animation: fadeInScale .2s ease-out;
  }
</style>
</head>
<body class="bg-white min-h-screen flex items-center justify-center px-4">

  <main class="w-full max-w-3xl bg-white shadow-2xl rounded-3xl p-10 border border-gray-100">

    <!-- HEADER -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-green-900 tracking-tight">
        Pegon Converter 
      </h1>
      <p class="text-sm text-gray-500 mt-2 tracking-wide">
        PPDA
      </p>
      <div class="h-[3px] w-16 bg-yellow-500 mx-auto mt-4 rounded-full"></div>
    </div>

    <!-- INPUT -->
    <div class="mb-6">
      <label class="text-gray-700 font-semibold text-sm mb-2 block">
        üìù Teks Latin
      </label>
      <textarea
        id="latinInput"
        rows="7"
        placeholder="Tulis teks Latin di sini..."
        class="w-full p-4 rounded-2xl border border-gray-200 
               focus:ring-2 focus:ring-green-800 focus:outline-none 
               resize-none text-gray-700 shadow-inner"></textarea>
    </div>

    <!-- BUTTON AREA -->
    <div class="flex gap-4 mb-8">

      <!-- BUTTON KONVERSI -->
      <button
        onclick="convert()"
        class="flex-1 bg-green-900 text-white font-semibold py-3 rounded-2xl 
       transition-all duration-200 ease-out
       hover:bg-green-800 hover:-translate-y-[1px]
       active:scale-95 shadow-lg green-glow">
        Konversi
        <div class="text-xs text-yellow-400 mt-1">Shift + Enter</div>
      </button>

      <!-- BUTTON CLEAR -->
      <button
        onclick="clearText()"
        class="px-6 bg-yellow-500 text-white font-semibold rounded-2xl 
       transition-all duration-200 ease-out
       hover:bg-yellow-400 hover:-translate-y-[1px]
       active:scale-95 shadow-lg gold-glow">
        Clear
      </button>

    </div>

    <!-- OUTPUT -->
    <div>
      <h2 class="text-gray-700 font-semibold text-sm mb-2">
        üìú Hasil Pegon
      </h2>

      <div
        id="pegonOutput"
        class="bg-white p-5 rounded-2xl border border-gray-200 
               text-2xl text-right leading-loose min-h-[140px] shadow-inner">
      </div>
      
      <!-- BUTTON COPY & DOWNLOAD -->
<div class="flex gap-4 mt-4">

  <!-- TOMBOL COPY -->
  <button
    onclick="copyPegon()"
    class="flex-1 bg-green-900 text-white font-semibold py-2.5 rounded-xl
           hover:bg-green-800 transition shadow-lg">
    üìã Copy
  </button>

  <!-- TOMBOL DOWNLOAD -->
<button
  onclick="openDownloadModal()"
  class="flex-1 bg-yellow-500 text-white font-semibold py-2.5 rounded-xl
         hover:bg-yellow-400 transition shadow-lg">
  ‚¨áÔ∏è Download
</button>

</div>
      
    </div>
<!-- FOOTER / POWERED BY -->
<div class="mt-10 text-center text-[11px] text-gray-400 tracking-wide">
  ¬©Powered by <span class="text-green-900 font-semibold">PP Daruttauhid Al Alawi</span>
</div>
  </main>

<script>
/* ==========================
   Pegon Converter ‚Äî Level 3
   (Embed kamus kecil contoh + fuzzy matching)
   Ganti blok script Anda dengan ini.
   ========================== */

/* ====== Peta Pegon lama (tetap dipakai) ====== */
const pegonMap = {
  ng: '⁄†', ny: '⁄Ω', sy: 'ÿ¥', kh: 'ÿÆ', sh: 'ÿ¥', ch: '⁄Ü',
  a: 'ÿß', i: 'Ÿä', u: 'Ÿà', e: 'Ÿì', o: 'Ÿà',
  b: 'ÿ®', c: '⁄Ü', d: 'ÿØ', f: 'ŸÅ', g: '⁄Æ', h: 'Ÿá',
  j: 'ÿ¨', k: 'ŸÉ', l: 'ŸÑ', m: 'ŸÖ', n: 'ŸÜ',
  p: 'ŸÅ', q: 'ŸÇ', r: 'ÿ±', s: 'ÿ≥', t: 'ÿ™',
  v: '⁄§', w: 'Ÿà', x: 'ÿÆ', y: 'Ÿä', z: 'ÿ≤'
};

const awalanVokal = { a:'ÿ£', i:'ÿ•Ÿä', u:'ÿ£Ÿà', o:'ÿ£Ÿà', e:'ÿ¢' };
const angkaMap = { '0':'Ÿ†','1':'Ÿ°','2':'Ÿ¢','3':'Ÿ£','4':'Ÿ§','5':'Ÿ•','6':'Ÿ¶','7':'Ÿß','8':'Ÿ®','9':'Ÿ©' };
const akhiranMap = { nya:"Ÿæÿß", mu:"ŸÖŸà", ku:"ŸÉŸà", kah:"ŸÉÿßŸá", lah:"ŸÑÿßŸá", pun:"ŸÅŸàŸÜ" };

const diftongAIFullWords = ["santai","lalai","ramai","lihai","nilai","pandai","lantai","rantai","balai","serai","selai","pantai"];
const diftongUIWords = ["kui","duit","kuil","kuih"];

/* ====== kamus contoh kecil (awal) ======
   Untuk produksi, nanti kita ganti dengan arab-dict.json besar (10k+)
   Struktur: key = bentuk latin normal (lowercase, no punctuation)
              value = ejaan Arab (string)
==========================================*/

/* ====== Normalisasi Latin ke bentuk standar untuk lookup ====== */
function normalizeArabicLatin(w) {
  return w.toLowerCase()
    .replace(/[^a-z0-9]/g,'')   // hapus non-alfanumerik
    .replace(/aa+/g,'a')        // reduksi vokal ganda
    .replace(/ii+/g,'i')
    .replace(/uu+/g,'u')
    .replace(/ou/g,'u')
    .replace(/oh/g,'u')
    .replace(/ph/g,'f')
    .replace(/ck/g,'k')
    .replace(/kh/g,'kh')
    .replace(/sh|sy/g,'sh')
    .replace(/zh/g,'zh')
    .replace(/dh/g,'dh')
    .replace(/th/g,'th')
    .replace(/gh/g,'gh')
    .replace(/q/g,'q')
    .replace(/w/g,'w')
    .replace(/j/g,'j');
}

/* ====== Levenshtein distance (untuk fuzzy match) ====== */
function levenshtein(a, b) {
  if (a === b) return 0;
  const m = a.length, n = b.length;
  if (m === 0) return n;
  if (n === 0) return m;
  let v0 = new Array(n+1), v1 = new Array(n+1);
  for (let i=0;i<=n;i++) v0[i]=i;
  for (let i=0;i<m;i++) {
    v1[0]=i+1;
    for (let j=0;j<n;j++) {
      const cost = a[i] === b[j] ? 0 : 1;
      v1[j+1] = Math.min(v1[j]+1, v0[j+1]+1, v0[j]+cost);
    }
    [v0,v1] = [v1,v0];
  }
  return v0[n];
}

async function loadArabicDictionary() {
  if (!window.arabDictLoaded) {
    const response = await fetch("arab-dict.json");
    window.arabDict = await response.json();

    // === Buat PREFIX INDEX ===
    window.arabPrefixIndex = {}; // { "a": [...], "b": [...], ... }

    for (let key in window.arabDict) {
      const prefix = key[0]; // huruf depan
      if (!window.arabPrefixIndex[prefix]) {
        window.arabPrefixIndex[prefix] = [];
      }
      window.arabPrefixIndex[prefix].push(key);
    }

    window.arabDictLoaded = true;
  }
}

// Cache untuk menyimpan hasil deteksi arab
let arabCache = {};

function vowelCount(s) {
  return (s.match(/[aeiou]/g) || []).length;
}

function consonantCount(s) {
  return (s.match(/[^aeiou]/g) || []).length;
}

// Hitung skor kesamaan huruf (semakin kecil semakin mirip)
function similarityScore(a, b) {
  let score = 0;

  // 1. perbedaan panjang
  score += Math.abs(a.length - b.length) * 0.5;

  // 2. perbedaan jumlah vokal
  score += Math.abs(vowelCount(a) - vowelCount(b)) * 1.2;

  // 3. perbedaan jumlah konsonan
  score += Math.abs(consonantCount(a) - consonantCount(b)) * 0.3;

  // 4. bonus: jika keduanya mengandung pola Arab (kh, gh, sy, dz)
  const arabPatterns = ['kh', 'gh', 'sy', 'sh', 'dz', 'ts'];
  for (let p of arabPatterns) {
    if (a.includes(p) && !b.includes(p)) score += 1.5;
    if (!a.includes(p) && b.includes(p)) score += 1.5;
  }

  return score;
}

function letterSimilarity(a, b) {
  // peta kemiripan huruf-huruf Arab-Latin
  const groups = [
    ["a", "aa"],
    ["u", "o", "oo"],
    ["i", "e"],
    ["h", "kh"],
    ["s", "sy", "sh"],
    ["d", "dz"],
    ["t", "ts"],
    ["g", "gh"],
    ["z", "zh"]
  ];

  // cari apakah keduanya masuk group yg sama
  for (let grp of groups) {
    if (grp.includes(a) && grp.includes(b)) {
      return 0.7; // huruf mirip ‚Üí skor rendah
    }
  }

  // default: tidak mirip
  return 1.4;
}
function syllableScore(a, b) {
  const patterns = [
    "rah", "rahm", "rhm",
    "mhm", "mhmmd", "mhmd",
    "fat", "fatm", "fath",
    "aisy", "aish", "syk", "sykr", "shkr",
    "allh", "all", "alhmd"
  ];

  let score = 0;

  for (let p of patterns) {
    if (a.includes(p) && b.includes(p)) {
      score -= 2; // lebih cocok ‚Üí kurangi score
    }
  }

  return score;
}
function weightedScore(a, b) {
  let score = 0;

  // skor dari levenshtein
  const dist = levenshtein(a, b);
  score += dist * 1.2;

  // hitung huruf per huruf berdasarkan kemiripan
  const minLen = Math.min(a.length, b.length);
  for (let i = 0; i < minLen; i++) {
    score += letterSimilarity(a[i], b[i]);
  }

  // suku kata (bonus untuk pola Arab)
  score += syllableScore(a, b);

  return score;
}

const arabPhrases = {
  "bismillahirrahmanirrahim": "ÿ®ÿ≥ŸÖ ÿßŸÑŸÑŸá ÿßŸÑÿ±ÿ≠ŸÖŸÜ ÿßŸÑÿ±ÿ≠ŸäŸÖ",
  "assalamualaikum": "ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖ",
  "warahmatullahiwabarakatuh": "Ÿàÿ±ÿ≠ŸÖÿ© ÿßŸÑŸÑŸá Ÿàÿ®ÿ±ŸÉÿßÿ™Ÿá",
  "alhamdulillahirabbilalamin": "ÿßŸÑÿ≠ŸÖÿØ ŸÑŸÑŸá ÿ±ÿ® ÿßŸÑÿπÿßŸÑŸÖŸäŸÜ",
  "insyaallah": "ÿ•ŸÜ ÿ¥ÿßÿ° ÿßŸÑŸÑŸá",
  "inshaallah": "ÿ•ŸÜ ÿ¥ÿßÿ° ÿßŸÑŸÑŸá",
  "masyaallah": "ŸÖÿß ÿ¥ÿßÿ° ÿßŸÑŸÑŸá"
};
function normalizePhrase(s) {
  return s
    .toLowerCase()
    .replace(/[^a-z]/g, "")           // hilangkan angka/tanda baca
    .replace(/aa+/g, "a")
    .replace(/ii+/g, "i")
    .replace(/uu+/g, "u")
    .replace(/sy/g, "sy")
    .replace(/sh/g, "sy")
    .replace(/kh/g, "kh")
    .replace(/gh/g, "gh")
    .replace(/ts/g, "ts")
    .replace(/dz/g, "dz");
}


/* ====== Deteksi apakah kata ada di kamus (langsung atau fuzzy) ====== */
async function detectArabicWord(word) {
  if (!word) return null;

  // 1. CEK CACHE
  if (arabCache[word] !== undefined) {
    return arabCache[word]; 
    // catatan: ini bisa return null jika memang tidak ada di kamus
  }

  // 2. LOAD KAMUS (sekali saja)
  await loadArabicDictionary();

  const norm = normalizeArabicLatin(word);

  // 3. EXACT MATCH
  if (window.arabDict[norm]) {
    arabCache[word] = window.arabDict[norm];  // SIMPAN di cache
    return window.arabDict[norm];
  }

// 4. FUZZY MATCH
const first = norm[0];
const candidates = window.arabPrefixIndex[first] || [];

let best = null;
let bestScore = Infinity;

for (let key of candidates) {
const score = weightedScore(norm, key);

  if (score < bestScore) {
    bestScore = score;
    best = key;
  }
}


  // threshold fuzzy: ‚â§ 40% panjang kata
const threshold = norm.length * 2.5; 
if (bestScore <= threshold) {
    arabCache[word] = window.arabDict[best];
    return window.arabDict[best];
}


  // 5. JIKA TIDAK KETEMU
  arabCache[word] = null; // simpan juga supaya tidak dihitung ulang
  return null;
}



/* ====== Utility tanda baca & wrapping ====== */
function stripPunc(s){ return s.replace(/^[\W_]+|[\W_]+$/g,''); }

/* wrapWithPunct:
   - ubah '?' menjadi 'ÿü'
   - '!' tetap '!'
   - letakkan tanda (ÿü atau !) setelah teks Arab (di kanan/akhir visual)
*/
function wrapWithPunct(original, arab){
  const lead = original.match(/^[\W_]+/) || [''];
  const trail = original.match(/[\?\!\.\,\:\;]+$/) || [''];
  let p = trail[0] || '';

  // convert ? to Arabic question mark
  p = p.replace(/\?/g, 'ÿü');

  // default: letakkan setelah arab (sebelumnya: beberapa implementasi menaruh di depan)
  return lead[0] + arab + p;
}

/* ====== Konversi kata ke Pegon (sebelumnya) ====== */
function convertWordToPegonSimple(word){
  if (!word) return "";

  // beberapa patch dan rules (mengikuti file asli Anda)
  if (word.includes("uai")) {
    return convertWordToPegonSimple(word.replace(/uai/g,"u_ai_patch"));
  }
  if (word.includes("u_ai_patch")) {
    return word
      .replace(/u_ai_patch/g,"Ÿà"+"ÿß"+"Ÿä")
      .split("")
      .map(ch => pegonMap[ch] || ch)
      .join("");
  }
  if (word.startsWith("bui")) {
    return "ÿ®Ÿàÿ¶Ÿä" + convertWordToPegonSimple(word.slice(3));
  }
  if (word.endsWith("ai")) {
    for (let w of diftongAIFullWords) {
      if (word === w || word.endsWith(w)) {
        let dasar = word.slice(0,-2);
        return convertWordToPegonSimple(dasar) + "ÿßŸä";
      }
    }
    let dasar = word.slice(0,-2);
    return convertWordToPegonSimple(dasar) + "ÿßÿ¶Ÿä";
  }
  if (word.includes("au")) {
    let out=""; let i=0;
    while (i<word.length) {
      if (word.slice(i,i+2)==="au"){ out+="ÿßŸà"; i+=2; continue; }
      let dua = word.slice(i,i+2);
      if (pegonMap[dua]){ out+=pegonMap[dua]; i+=2; continue; }
      out += pegonMap[word[i]] || word[i]; i++;
    }
    return out;
  }
  if (word.endsWith("ui")) {
    for (let w of diftongUIWords) {
      if (word === w || word.endsWith(w)) {
        let dasar = word.slice(0,-2);
        return convertWordToPegonSimple(dasar) + "ŸàŸä";
      }
    }
    let dasar = word.slice(0,-2);
    return convertWordToPegonSimple(dasar) + "Ÿàÿ¶Ÿä";
  }
  if (word.endsWith("ia")) {
    if (word==="biaya") return "ÿ®ŸäÿßŸäÿß";
    let dasar = word.slice(0,-2);
    return convertWordToPegonSimple(dasar) + "Ÿäÿß";
  }
  if (word === "kue" || word.endsWith("kue")) {
    let dasar = word.slice(0,-3);
    return convertWordToPegonSimple(dasar) + "ŸÉŸèŸàÿ¶Ÿä";
  }
  if (word.endsWith("ei")) {
    let dasar = word.slice(0,-2);
    return convertWordToPegonSimple(dasar) + "Ÿìÿ¶Ÿä";
  }
  if (word.includes("ua")) {
    let out=''; let i=0;
    while (i<word.length){
      if (word.slice(i,i+2)==='ua'){ out+='Ÿàÿß'; i+=2; continue; }
      let dua=word.slice(i,i+2);
      if (pegonMap[dua]){ out+=pegonMap[dua]; i+=2; continue; }
      out += pegonMap[word[i]] || word[i]; i++;
    }
    return out;
  }

  // default per huruf
  let hasil=""; let i=0;
  if (/^[aeiou]/.test(word)) { hasil+=awalanVokal[word[0]]; i=1; }

  while (i<word.length){
    let dua = word.slice(i,i+2).toLowerCase();
    if (pegonMap[dua]){ hasil+=pegonMap[dua]; i+=2; continue; }
    hasil += pegonMap[word[i]] || word[i];
    i++;
  }
  return hasil;
}
function detectArabicPhrase(raw) {
  let n = normalizePhrase(raw);

  let best = null;
  let bestScore = Infinity;

  for (let key in arabPhrases) {
    const score = weightedScore(n, key);
    if (score < bestScore) {
      bestScore = score;
      best = key;
    }
  }

  // threshold phrase lebih longgar
  if (bestScore <= n.length * 3) {
    return arabPhrases[best];
  }

  return null;
}

/* ====== Fungsi utama: convertToPegon (async agar bisa menunggu detektor) ====== */
async function convertToPegon(teks) {
  let parts = teks.split(/(\s+)/); 
  let hasil = "";

  for (let part of parts) {

    // jika spasi -> lanjut
    if (/^\s+$/.test(part)) { 
      hasil += part; 
      continue; 
    }

    // ambil kata tanpa tanda baca
    let raw = stripPunc(part);
    let lower = raw.toLowerCase();

    /* =====================================================
       0. AUTO PHRASE DETECTION (penambahan di Step 4)
       ===================================================== */
    let phrase = detectArabicPhrase(raw);
    if (phrase) {
      hasil += wrapWithPunct(part, phrase);
      continue; // langsung lanjut ke kata berikutnya
    }

    /* =====================================================
       1. DETEKSI KATA ARAB BIASA (KAMUS  + FUZZY + AI)
       ===================================================== */
    let arabDetected = await detectArabicWord(lower);
    if (arabDetected) {
      hasil += wrapWithPunct(part, arabDetected);
      continue;
    }

    /* =====================================================
       2. OVERRIDE MANUAL (jika user punya kamus sendiri)
       ===================================================== */
    if (window.arabOverride && window.arabOverride[lower]) {
      hasil += wrapWithPunct(part, window.arabOverride[lower]);
      continue;
    }

    /* =====================================================
       3. ANGKA ‚Üí ARAB-INDIC
       ===================================================== */
    if (/^\d+$/.test(raw)) {
      hasil += wrapWithPunct(
        part,
        raw.split("").map(ch => angkaMap[ch] || ch).join("")
      );
      continue;
    }

    /* =====================================================
       4. KONVERSI PEGON NORMAL (fallback)
       ===================================================== */
    hasil += wrapWithPunct(part, convertWordToPegonSimple(lower));
  }

  return hasil;
}


/* ====== fungsi tombol, copy, download (dipertahankan) ====== */
function clearText(){
  document.getElementById("latinInput").value = "";
  document.getElementById("pegonOutput").innerText = "";
}

function copyPegon() {
  const text = document.getElementById("pegonOutput").innerText;
  if (!text) { showToast("‚ö†Ô∏è Tidak ada teks untuk disalin", "bg-red-600"); return; }
  const textarea = document.createElement("textarea");
  textarea.value = text;
  document.body.appendChild(textarea);
  textarea.select();
  textarea.setSelectionRange(0, 99999);
  try { document.execCommand("copy"); showToast("‚úÖ Berhasil disalin!"); }
  catch (err) { showToast("‚ùå Gagal menyalin", "bg-red-600"); }
  document.body.removeChild(textarea);
}
function showToast(message, colorClass = "bg-green-900") {
  const toast = document.getElementById("toast");
  const toastText = document.getElementById("toastText");
  toast.className = `fixed top-6 right-6 text-white px-5 py-3 rounded-2xl shadow-2xl opacity-0 pointer-events-none -translate-y-4 transition-all duration-300 ${colorClass}`;
  toastText.innerText = message;
  setTimeout(() => { toast.classList.add("toast-show"); }, 50);
  setTimeout(() => { toast.classList.remove("toast-show"); }, 2500);
}

function downloadPegon(){
  const text = document.getElementById("pegonOutput").innerText;
  if(!text){ showToast("‚ö†Ô∏è Tidak ada teks untuk diunduh", "bg-red-600"); return; }
  const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);
  const now = new Date(); const tanggal = now.toISOString().slice(0,10);
  const waktu = now.toTimeString().slice(0,8).replace(/:/g, "-");
  const filename = `pegon-${tanggal}-${waktu}.txt`;
  const a = document.createElement("a"); a.href = url; a.download = filename; a.click();
  URL.revokeObjectURL(url);
  showToast("‚¨áÔ∏è File berhasil diunduh");
}

/* ====== Convert button wrapper (async) ====== */
async function convert(){
  let input = document.getElementById("latinInput").value;
  document.getElementById("pegonOutput").innerText = await convertToPegon(input);
}

/* ====== Keyboard shortcut (Shift+Enter) - gunakan async handler ====== */
document.addEventListener("keydown", async function(e){
  if (e.shiftKey && e.key === "Enter") {
    e.preventDefault();
    await convert();
  }
});

/* ====== Download modal helpers (dipertahankan) ====== */
function openDownloadModal(){
  const text = document.getElementById("pegonOutput").innerText;
  if(!text){ showToast("‚ö†Ô∏è Tidak ada teks untuk diunduh", "bg-red-600"); return; }
  document.getElementById("downloadModal").classList.remove("hidden");
  const now = new Date(); const tanggal = now.toISOString().slice(0,10);
  const waktu = now.toTimeString().slice(0,8).replace(/:/g, "-");
  document.getElementById("fileNameInput").value = `pegon-${tanggal}-${waktu}`;
}
function closeDownloadModal(){ document.getElementById("downloadModal").classList.add("hidden"); }
function confirmDownload(){
  const text = document.getElementById("pegonOutput").innerText;
  const nameInput = document.getElementById("fileNameInput").value.trim();
  const type = document.getElementById("fileTypeSelect").value;
  const filename = nameInput ? `${nameInput}.${type}` : `hasil-pegon.${type}`;
  if(type === "pdf"){ generatePDF(text, filename); closeDownloadModal(); showToast("‚¨áÔ∏è PDF berhasil dibuat"); return; }
  const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a"); a.href = url; a.download = filename; a.click();
  URL.revokeObjectURL(url); closeDownloadModal(); showToast("‚¨áÔ∏è File berhasil diunduh");
}
function generatePDF(text, filename) {
  const win = window.open('', '_blank');
  win.document.write(`<html><head><title>${filename}</title></head><body style="font-family: serif; white-space: pre-wrap;">${text.replace(/\n/g, '<br>')}</body></html>`);
  win.document.close();
  win.print();
}
</script>


<!-- TOAST NOTIFICATION -->
<div id="toast" class="fixed top-6 right-6 bg-green-900 text-white 
     px-5 py-3 rounded-2xl shadow-2xl opacity-0 pointer-events-none 
     -translate-y-4 transition-all duration-300">
  <span id="toastText">‚úÖ Copied!</span>
</div>
<!-- DOWNLOAD MODAL -->
<div id="downloadModal" class="fixed inset-0 bg-black/40 hidden flex items-center justify-center z-50">
  <div class="bg-white rounded-2xl shadow-2xl p-6 w-[90%] max-w-md animate-fade-in">

    <h3 class="text-xl font-bold mb-4 text-gray-800">Download File</h3>

    <!-- Nama File -->
    <label class="text-sm font-semibold text-gray-600">Nama File</label>
    <input
      id="fileNameInput"
      type="text"
      class="w-full mt-1 mb-4 p-3 border rounded-xl focus:ring-2 focus:ring-green-800 outline-none"
      placeholder="contoh: hasil-pegon"
    >

    <!-- Jenis File -->
    <label class="text-sm font-semibold text-gray-600">Jenis File</label>
<select
  id="fileTypeSelect"
  class="w-full mt-1 mb-5 p-3 border rounded-xl focus:ring-2 focus:ring-green-800 outline-none">
  <option value="txt">.txt (Text)</option>
  <option value="doc">.doc (Word)</option>
  <option value="pdf">.pdf (PDF)</option>
</select>

    <!-- Tombol -->
    <div class="flex gap-3">
      <button
        onclick="closeDownloadModal()"
        class="flex-1 py-2 rounded-xl bg-gray-200 hover:bg-gray-300 transition font-semibold">
        Batal
      </button>

      <button
        onclick="confirmDownload()"
        class="flex-1 py-2 rounded-xl bg-green-900 text-white hover:bg-green-800 transition font-semibold">
        Download
      </button>
    </div>

  </div>
</div>
</body>
</html>

